# Alternative Apache configuration with explicit WebSocket handling

<VirtualHost *:443>
    ServerName openmosaics.com
    
    # SSL Configuration
    SSLEngine on
    SSLCertificateFile /path/to/your/cert.pem
    SSLCertificateKeyFile /path/to/your/private.key
    
    # WebSocket Support Headers
    Header always set Connection "Upgrade"
    Header always set Upgrade "websocket"
    
    # Socket.IO WebSocket proxy with specific upgrade handling
    <Location "/ws/socket.io/">
        ProxyPass "ws://localhost:3000/ws/socket.io/"
        ProxyPassReverse "ws://localhost:3000/ws/socket.io/"
        ProxyPreserveHost On
        
        # Headers for WebSocket upgrade
        ProxySet connectiontimeout 300
        ProxySet ttl 300
        
        # Allow WebSocket upgrade
        Header always set Connection "upgrade"
        Header always set Upgrade "websocket"
    </Location>
    
    # Fallback for Socket.IO polling
    <Location "/ws/">
        ProxyPass "http://localhost:3000/ws/"
        ProxyPassReverse "http://localhost:3000/ws/"
        ProxyPreserveHost On
    </Location>
    
    # Main application
    ProxyPass /api/ http://localhost:3000/api/
    ProxyPassReverse /api/ http://localhost:3000/api/
    
    ProxyPass / http://localhost:3000/
    ProxyPassReverse / http://localhost:3000/
    ProxyPreserveHost On
</VirtualHost>
